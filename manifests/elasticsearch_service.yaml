# ================================================================
# ELASTICSEARCH SERVICE
# Servicio Headless para descubrimiento y comunicación de nodos
# ================================================================

apiVersion: v1                # Versión de la API de Kubernetes usada (v1 para recursos básicos)
kind: Service                 # Tipo de recurso: un Service expone uno o más Pods dentro del clúster

metadata:                     # Información descriptiva del objeto
  name: elasticsearch         # Nombre único del servicio (usado para DNS interno)
  namespace: logging          # Espacio de nombres donde se despliega el servicio

spec:                         # Especificaciones funcionales del servicio
  clusterIP: None             # "None" indica que es un servicio headless (sin IP fija)
                              # Permite la comunicación directa entre Pods (útil en clústeres como Elasticsearch)
  ports:                      # Lista de puertos expuestos por el servicio
    - port: 9200              # Puerto HTTP/REST principal para peticiones externas (por ejemplo, desde Kibana o curl)
      name: rest              # Nombre descriptivo del puerto (REST API)
    - port: 9300              # Puerto usado para la comunicación interna entre nodos del clúster
      name: inter-node        # Nombre descriptivo del puerto (inter-node communication)
  selector:                   # Selector que asocia este servicio con los Pods correctos
    app: elasticsearch        # Debe coincidir con la etiqueta "app: elasticsearch" en los Pods

# ---------------------------------------------------------------
# RESUMEN:
# - clusterIP: None => Headless Service, sin balanceador.
# - puerto 9200 => API REST de Elasticsearch.
# - puerto 9300 => Comunicación interna de clúster.
# - selector => Conecta el servicio a los Pods etiquetados como "app: elasticsearch".
# ---------------------------------------------------------------
